(()=>{var e={};e.id=706,e.ids=[706],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},8621:e=>{"use strict";e.exports=require("punycode")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1568:e=>{"use strict";e.exports=require("zlib")},862:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>o,routeModule:()=>m,tree:()=>d}),s(4263),s(9623),s(5866);var r=s(3191),a=s(8716),i=s(7922),l=s.n(i),n=s(5231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(t,c);let d=["",{children:["acties",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4263)),"/Users/dietmar/Desktop/pp ops -- intern audit/app/acties/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9623)),"/Users/dietmar/Desktop/pp ops -- intern audit/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/dietmar/Desktop/pp ops -- intern audit/app/acties/page.tsx"],u="/acties/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/acties/page",pathname:"/acties",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8968:(e,t,s)=>{Promise.resolve().then(s.bind(s,446))},446:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var r=s(326),a=s(7577),i=s(5047),l=s(2711),n=s(2894),c=s(1714),d=s(3116),o=s(1021),u=s(2896),x=s(3771);let m=({actions:e,selectedAction:t,onActionSelect:s,getUrgencyColor:a,getStatusColor:l,getUrgencyLabel:n,getStatusLabel:c})=>{let d=(0,i.useRouter)(),u=e=>new Date(e).toLocaleDateString("nl-NL",{day:"2-digit",month:"2-digit",year:"numeric"}),x=e=>!!e&&new Date(e)<new Date;return 0===e.length?r.jsx(o.Zb,{className:"p-6",children:r.jsx("div",{className:"text-center text-gray-500",children:r.jsx("p",{children:"Geen acties gevonden"})})}):r.jsx("div",{className:"space-y-4",children:e.map(e=>r.jsx(o.Zb,{className:`p-4 cursor-pointer transition-all duration-200 hover:shadow-md ${t?.id===e.id?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>d.push(`/acties/${e.id}`),children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.titel}),r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${a(e.urgentie)}`,children:n(e.urgentie)}),r.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full border ${l(e.status)}`,children:c(e.status)})]}),r.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.beschrijving}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.audit?.filialen&&(0,r.jsxs)("span",{children:[e.audit.filialen.naam," - ",e.audit.filialen.locatie]}),e.deadline&&(0,r.jsxs)("span",{className:x(e.deadline)&&"completed"!==e.status&&"verified"!==e.status?"text-red-600 font-medium":"",children:["Deadline: ",u(e.deadline),x(e.deadline)&&"completed"!==e.status&&"verified"!==e.status&&" (Verlopen)"]}),e.toegewezen_gebruiker&&(0,r.jsxs)("span",{children:["Toegewezen aan: ",e.toegewezen_gebruiker.naam]})]})]}),r.jsx("div",{className:"ml-4 flex-shrink-0",children:e.audit_resultaat?.audit_checklist_items&&(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("div",{className:"text-xs text-gray-500",children:e.audit_resultaat.audit_checklist_items.categorie}),(0,r.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["Score: ",e.audit_resultaat.score,"/5"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Gewicht: ",e.audit_resultaat.audit_checklist_items.gewicht]})]})})]})},e.id))})};var g=s(4231),h=s(3679);let p=({filters:e,onFiltersChange:t})=>{let s=(s,r)=>{t({...e,[s]:r})};return r.jsx(o.Zb,{className:"p-6",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),r.jsx(h.z,{onClick:()=>{t({status:"all",urgentie:"all",search:""})},variant:"outline",size:"sm",children:"Wissen"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Zoeken"}),r.jsx(g.I,{type:"text",placeholder:"Zoek in titel of beschrijving...",value:e.search,onChange:e=>s("search",e.target.value)})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:e.status,onChange:e=>s("status",e.target.value),children:[r.jsx("option",{value:"all",children:"Alle statussen"}),r.jsx("option",{value:"pending",children:"In afwachting"}),r.jsx("option",{value:"in_progress",children:"Bezig"}),r.jsx("option",{value:"completed",children:"Voltooid"}),r.jsx("option",{value:"verified",children:"Geverifieerd"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Urgentie"}),(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:e.urgentie,onChange:e=>s("urgentie",e.target.value),children:[r.jsx("option",{value:"all",children:"Alle urgenties"}),r.jsx("option",{value:"critical",children:"Kritiek"}),r.jsx("option",{value:"high",children:"Hoog"}),r.jsx("option",{value:"medium",children:"Gemiddeld"}),r.jsx("option",{value:"low",children:"Laag"})]})]})]})]})})};var f=s(1625);let j=()=>{let{user:e}=(0,l.a)(),[t,s]=(0,a.useState)([]),[i,g]=(0,a.useState)(""),[h,j]=(0,a.useState)([]),[b,v]=(0,a.useState)(!0),[y,N]=(0,a.useState)(""),[w,_]=(0,a.useState)({status:"all",urgentie:"all",search:""}),k=async()=>{try{let t=await f.l.getFilialen();s(t),t.length>0&&(e?.rol==="admin"||e?.rol==="coo"||e?.rol==="district_manager"?g("all"):g(t[0].id))}catch(e){N("Fout bij het laden van filialen"),console.error("Error loading filialen:",e)}},D=async()=>{try{v(!0),N("");let e=await f.l.getActions("all"===i?void 0:i);if(console.log("\uD83D\uDD0D Debug - Selected filiaal:",i),console.log("\uD83D\uDD0D Debug - Actions data:",e),console.log("\uD83D\uDD0D Debug - Actions count:",e?.length||0),!e||0===e.length){console.log("⚠️ No actions found"),j([]),v(!1);return}if("all"!==w.status&&(e=e.filter(e=>e.status===w.status)),"all"!==w.urgentie&&(e=e.filter(e=>e.urgentie===w.urgentie)),w.search){let t=w.search.toLowerCase();e=e.filter(e=>e.titel.toLowerCase().includes(t)||e.beschrijving.toLowerCase().includes(t))}let t=(await Promise.all(e.map(async e=>{let t={...e};try{let s=await f.l.getAuditById(e.audit_id);if(s){let e=await f.l.getFiliaalById(s.filiaal_id);t.audit={...s,filialen:e}}if(t.audit_resultaat={checklist_item_id:e.audit_resultaat_id,resultaat:"niet_ok",score:2,opmerkingen:"Verbetering nodig",verbeterpunt:e.beschrijving,audit_checklist_items:{categorie:"Algemene Properheid",titel:e.titel.replace("Actie vereist: ",""),beschrijving:e.beschrijving,gewicht:1.5}},e.toegewezen_aan){let s=await f.l.getUserById(e.toegewezen_aan);s&&(t.toegewezen_gebruiker={naam:s.naam,rol:s.rol})}if(e.voltooid_door){let s=await f.l.getUserById(e.voltooid_door);s&&(t.voltooid_gebruiker={naam:s.naam})}if(e.geverifieerd_door){let s=await f.l.getUserById(e.geverifieerd_door);s&&(t.geverifieerd_gebruiker={naam:s.naam})}}catch(e){console.error("Error enriching action data:",e)}return t}))).sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime());j(t)}catch(e){console.error("Error fetching actions:",e),N(`Fout bij het laden van acties: ${e instanceof Error?e.message:"Onbekende fout"}`)}finally{v(!1)}};(0,a.useEffect)(()=>{e&&k()},[e]),(0,a.useEffect)(()=>{i&&D()},[i,w]);let A=(()=>{let e=h.length,t=h.filter(e=>"pending"===e.status).length,s=h.filter(e=>"in_progress"===e.status).length,r=h.filter(e=>"completed"===e.status).length;return{totalActions:e,pendingActions:t,inProgressActions:s,completedActions:r,verifiedActions:h.filter(e=>"verified"===e.status).length,criticalActions:h.filter(e=>"critical"===e.urgentie).length,overdueActions:h.filter(e=>e.deadline&&new Date(e.deadline)<new Date&&"completed"!==e.status&&"verified"!==e.status).length}})();return b?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(u.T,{})}):y?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsx("div",{className:"max-w-md w-full",children:r.jsx(x.b,{variant:"error",children:y})})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(n.x,{user:e}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 pb-28",children:[r.jsx(o.Zb,{className:"mb-8",children:r.jsx(o.Ol,{children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h1",{className:"text-3xl font-semibold text-neutral-900 mb-2",children:"Acties"}),r.jsx("p",{className:"text-neutral-600",children:"Beheer en volg acties die voortvloeien uit audits"})]})})}),r.jsx("div",{className:"mb-6",children:r.jsx(c.r,{filialen:t,selectedFiliaal:i,onFiliaalChange:g,userRole:e?.rol})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-8",children:[r.jsx(o.Zb,{children:r.jsx(o.eW,{className:"p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Totaal Acties"}),r.jsx("p",{className:"text-lg font-semibold text-gray-900 mb-1",children:A.totalActions}),r.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:"Alle acties"})]})})}),r.jsx(o.Zb,{children:r.jsx(o.eW,{className:"p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Kritiek"}),r.jsx("p",{className:"text-lg font-semibold text-red-600 mb-1",children:A.criticalActions}),r.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:"Urgente acties"})]})})}),r.jsx(o.Zb,{children:r.jsx(o.eW,{className:"p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"In Behandeling"}),r.jsx("p",{className:"text-lg font-semibold text-blue-600 mb-1",children:A.pendingActions+A.inProgressActions}),r.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:"Openstaande acties"})]})})}),r.jsx(o.Zb,{children:r.jsx(o.eW,{className:"p-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Verlopen"}),r.jsx("p",{className:"text-lg font-semibold text-orange-600 mb-1",children:A.overdueActions}),r.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:"Deadline overschreden"})]})})})]}),r.jsx("div",{className:"max-w-4xl mx-auto",children:(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(p,{filters:w,onFiltersChange:_}),r.jsx(m,{actions:h,selectedAction:null,onActionSelect:()=>{},getUrgencyColor:e=>{switch(e){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},getStatusColor:e=>{switch(e){case"pending":default:return"text-gray-600 bg-gray-50 border-gray-200";case"in_progress":return"text-blue-600 bg-blue-50 border-blue-200";case"completed":return"text-green-600 bg-green-50 border-green-200";case"verified":return"text-purple-600 bg-purple-50 border-purple-200"}},getUrgencyLabel:e=>{switch(e){case"critical":return"Kritiek";case"high":return"Hoog";case"medium":return"Gemiddeld";case"low":return"Laag";default:return"Onbekend"}},getStatusLabel:e=>{switch(e){case"pending":return"In afwachting";case"in_progress":return"Bezig";case"completed":return"Voltooid";case"verified":return"Geverifieerd";default:return"Onbekend"}}})]})})]}),r.jsx(d.$,{})]})};function b(){let{user:e,loading:t}=(0,l.a)();return((0,i.useRouter)(),t)?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx(u.T,{})}):e?r.jsx(j,{}):null}},1714:(e,t,s)=>{"use strict";s.d(t,{r:()=>l});var r=s(326);s(7577);var a=s(1021);let i=(0,s(6557).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),l=({filialen:e,selectedFiliaal:t,onFiliaalChange:s,userRole:l})=>{let n=e.find(e=>e.id===t);return r.jsx(a.Zb,{children:r.jsx(a.eW,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[r.jsx("div",{className:"flex items-center space-x-3",children:(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[r.jsx("h2",{className:"text-sm sm:text-lg font-semibold text-gray-900",children:"Geselecteerd Filiaal"}),"all"===t?r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:"Alle Filialen"}):n?r.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:n.naam}):null]})}),(0,r.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,r.jsxs)("select",{value:t,onChange:e=>s(e.target.value),className:"appearance-none bg-white border border-gray-300 rounded-md px-3 py-2 pr-8 text-xs sm:text-sm font-medium text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 w-full sm:w-auto min-w-[140px]",children:["admin"===l&&r.jsx("option",{value:"all",children:"Alle Filialen"}),e.map(e=>r.jsx("option",{value:e.id,children:e.naam},e.id))]}),r.jsx(i,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]})]})})})}},4231:(e,t,s)=>{"use strict";s.d(t,{I:()=>i});var r=s(326),a=s(7577);let i=s.n(a)().forwardRef(({className:e,type:t,error:s,label:a,...i},l)=>(0,r.jsxs)("div",{className:"w-full",children:[a&&r.jsx("label",{className:"form-label",children:a}),r.jsx("input",{type:t,className:`form-input ${s?"border-danger-300 focus:border-danger-500 focus:ring-danger-500":""} ${e||""}`,ref:l,...i}),s&&r.jsx("p",{className:"form-error",children:s})]}));i.displayName="Input"},7888:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7202:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},4659:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},8019:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},5290:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(6557).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5047:(e,t,s)=>{"use strict";var r=s(7389);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},4263:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/Users/dietmar/Desktop/pp ops -- intern audit/app/acties/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[994,897,941],()=>s(862));module.exports=r})();
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[706],{7856:function(e,t,s){Promise.resolve().then(s.bind(s,8721))},8721:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var i=s(7437),a=s(2265),l=s(9376),r=s(1618),n=s(8243),c=s(1243),d=s(8270),o=s(9178),u=s(5012),x=s(5225);let g=e=>{let{actions:t,selectedAction:s,onActionSelect:a,getUrgencyColor:r,getStatusColor:n,getUrgencyLabel:c,getStatusLabel:d}=e,u=(0,l.useRouter)(),x=e=>new Date(e).toLocaleDateString("nl-NL",{day:"2-digit",month:"2-digit",year:"numeric"}),g=e=>!!e&&new Date(e)<new Date;return 0===t.length?(0,i.jsx)(o.Zb,{className:"p-6",children:(0,i.jsx)("div",{className:"text-center text-gray-500",children:(0,i.jsx)("p",{children:"Geen acties gevonden"})})}):(0,i.jsx)("div",{className:"space-y-4",children:t.map(e=>{var t,a;return(0,i.jsx)(o.Zb,{className:"p-4 cursor-pointer transition-all duration-200 hover:shadow-md ".concat((null==s?void 0:s.id)===e.id?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"),onClick:()=>u.push("/acties/detail?id=".concat(e.id)),children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.titel}),(0,i.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full border ".concat(r(e.urgentie)),children:c(e.urgentie)}),(0,i.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full border ".concat(n(e.status)),children:d(e.status)})]}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.beschrijving}),(0,i.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(null===(t=e.audit)||void 0===t?void 0:t.filialen)&&(0,i.jsxs)("span",{children:[e.audit.filialen.naam," - ",e.audit.filialen.locatie]}),e.deadline&&(0,i.jsxs)("span",{className:g(e.deadline)&&"completed"!==e.status&&"verified"!==e.status?"text-red-600 font-medium":"",children:["Deadline: ",x(e.deadline),g(e.deadline)&&"completed"!==e.status&&"verified"!==e.status&&" (Verlopen)"]}),e.toegewezen_gebruiker&&(0,i.jsxs)("span",{children:["Toegewezen aan: ",e.toegewezen_gebruiker.naam]})]})]}),(0,i.jsx)("div",{className:"ml-4 flex-shrink-0",children:(null===(a=e.audit_resultaat)||void 0===a?void 0:a.audit_checklist_items)&&(0,i.jsxs)("div",{className:"text-right",children:[(0,i.jsx)("div",{className:"text-xs text-gray-500",children:e.audit_resultaat.audit_checklist_items.categorie}),(0,i.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["Score: ",e.audit_resultaat.score,"/5"]}),(0,i.jsxs)("div",{className:"text-xs text-gray-500",children:["Gewicht: ",e.audit_resultaat.audit_checklist_items.gewicht]})]})})]})},e.id)})})};var m=s(8068),h=s(4226);let f=e=>{let{filters:t,onFiltersChange:s}=e,a=(e,i)=>{s({...t,[e]:i})};return(0,i.jsx)(o.Zb,{className:"p-6",children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),(0,i.jsx)(h.z,{onClick:()=>{s({status:"all",urgentie:"all",search:""})},variant:"outline",size:"sm",children:"Wissen"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Zoeken"}),(0,i.jsx)(m.I,{type:"text",placeholder:"Zoek in titel of beschrijving...",value:t.search,onChange:e=>a("search",e.target.value)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,i.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.status,onChange:e=>a("status",e.target.value),children:[(0,i.jsx)("option",{value:"all",children:"Alle statussen"}),(0,i.jsx)("option",{value:"pending",children:"In afwachting"}),(0,i.jsx)("option",{value:"in_progress",children:"Bezig"}),(0,i.jsx)("option",{value:"completed",children:"Voltooid"}),(0,i.jsx)("option",{value:"verified",children:"Geverifieerd"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Urgentie"}),(0,i.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t.urgentie,onChange:e=>a("urgentie",e.target.value),children:[(0,i.jsx)("option",{value:"all",children:"Alle urgenties"}),(0,i.jsx)("option",{value:"critical",children:"Kritiek"}),(0,i.jsx)("option",{value:"high",children:"Hoog"}),(0,i.jsx)("option",{value:"medium",children:"Gemiddeld"}),(0,i.jsx)("option",{value:"low",children:"Laag"})]})]})]})]})})};var p=s(1181);let j=()=>{let{user:e}=(0,r.a)(),[t,s]=(0,a.useState)([]),[l,m]=(0,a.useState)(""),[h,j]=(0,a.useState)([]),[v,b]=(0,a.useState)(!0),[_,N]=(0,a.useState)(""),[y,w]=(0,a.useState)({status:"all",urgentie:"all",search:""}),k=async()=>{try{let t=await p.l.getFilialen();s(t),t.length>0&&((null==e?void 0:e.rol)==="admin"||(null==e?void 0:e.rol)==="coo"||(null==e?void 0:e.rol)==="district_manager"?m("all"):m(t[0].id))}catch(e){N("Fout bij het laden van filialen"),console.error("Error loading filialen:",e)}},D=async()=>{try{b(!0),N("");let e=await p.l.getActions("all"===l?void 0:l);if(console.log("\uD83D\uDD0D Debug - Selected filiaal:",l),console.log("\uD83D\uDD0D Debug - Actions data:",e),console.log("\uD83D\uDD0D Debug - Actions count:",(null==e?void 0:e.length)||0),!e||0===e.length){console.log("⚠️ No actions found"),j([]),b(!1);return}let t=e.map(e=>({id:e.id,audit_id:e.audit_id,audit_resultaat_id:e.audit_resultaat_id,titel:e.titel,beschrijving:e.beschrijving,urgentie:e.urgentie,status:e.status,toegewezen_aan:e.toegewezen_aan,deadline:e.deadline,actie_onderneem:e.actie_onderneem,foto_urls:e.foto_urls||[],voltooid_door:e.voltooid_door,voltooid_op:e.voltooid_op,geverifieerd_door:e.geverifieerd_door,geverifieerd_op:e.geverifieerd_op,verificatie_opmerkingen:e.verificatie_opmerkingen,created_at:e.created_at,updated_at:e.updated_at,audit:e.audits?{id:e.audits.id,filiaal_id:e.audits.filiaal_id,audit_datum:e.audits.audit_datum,totale_score:e.audits.totale_score,pass_percentage:e.audits.pass_percentage,filialen:e.audits.filialen}:void 0,audit_resultaat:e.audit_resultaten?{checklist_item_id:e.audit_resultaten.checklist_item_id,resultaat:e.audit_resultaten.resultaat,score:e.audit_resultaten.score,opmerkingen:e.audit_resultaten.opmerkingen,verbeterpunt:e.audit_resultaten.verbeterpunt,audit_checklist_items:e.audit_resultaten.audit_checklist_items}:void 0}));if("all"!==y.status&&(t=t.filter(e=>e.status===y.status)),"all"!==y.urgentie&&(t=t.filter(e=>e.urgentie===y.urgentie)),y.search){let e=y.search.toLowerCase();t=t.filter(t=>t.titel.toLowerCase().includes(e)||t.beschrijving.toLowerCase().includes(e))}j(t)}catch(e){console.error("Error fetching actions:",e),N("Fout bij het laden van acties: ".concat(e instanceof Error?e.message:"Onbekende fout"))}finally{b(!1)}};(0,a.useEffect)(()=>{e&&k()},[e]),(0,a.useEffect)(()=>{l&&D()},[l,y]);let A=(()=>{let e=h.length,t=h.filter(e=>"pending"===e.status).length,s=h.filter(e=>"in_progress"===e.status).length,i=h.filter(e=>"completed"===e.status).length;return{totalActions:e,pendingActions:t,inProgressActions:s,completedActions:i,verifiedActions:h.filter(e=>"verified"===e.status).length,criticalActions:h.filter(e=>"critical"===e.urgentie).length,overdueActions:h.filter(e=>e.deadline&&new Date(e.deadline)<new Date&&"completed"!==e.status&&"verified"!==e.status).length}})();return v?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)(u.T,{})}):_?(0,i.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,i.jsx)("div",{className:"max-w-md w-full",children:(0,i.jsx)(x.b,{variant:"error",children:_})})}):(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,i.jsx)(n.x,{user:e}),(0,i.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 pb-28",children:[(0,i.jsx)(o.Zb,{className:"mb-8",children:(0,i.jsx)(o.Ol,{children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h1",{className:"text-3xl font-semibold text-neutral-900 mb-2",children:"Acties"}),(0,i.jsx)("p",{className:"text-neutral-600",children:"Beheer en volg acties die voortvloeien uit audits"})]})})}),(0,i.jsx)("div",{className:"mb-6",children:(0,i.jsx)(c.r,{filialen:t,selectedFiliaal:l,onFiliaalChange:m,userRole:null==e?void 0:e.rol})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-8",children:[(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.eW,{className:"p-4",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Totaal Acties"}),(0,i.jsx)("p",{className:"text-lg font-semibold text-gray-900 mb-1",children:A.totalActions}),(0,i.jsx)("p",{className:"text-xs text-gray-500 leading-tight",children:"Alle acties"})]})})}),(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.eW,{className:"p-4",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Kritiek"}),(0,i.jsx)("p",{className:"text-lg font-semibold text-red-600 mb-1",children:A.criticalActions}),(0,i.jsx)("p",{className:"text-xs text-gray-500 leading-tight",children:"Urgente acties"})]})})}),(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.eW,{className:"p-4",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"In Behandeling"}),(0,i.jsx)("p",{className:"text-lg font-semibold text-blue-600 mb-1",children:A.pendingActions+A.inProgressActions}),(0,i.jsx)("p",{className:"text-xs text-gray-500 leading-tight",children:"Openstaande acties"})]})})}),(0,i.jsx)(o.Zb,{children:(0,i.jsx)(o.eW,{className:"p-4",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:"Verlopen"}),(0,i.jsx)("p",{className:"text-lg font-semibold text-orange-600 mb-1",children:A.overdueActions}),(0,i.jsx)("p",{className:"text-xs text-gray-500 leading-tight",children:"Deadline overschreden"})]})})})]}),(0,i.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(f,{filters:y,onFiltersChange:w}),(0,i.jsx)(g,{actions:h,selectedAction:null,onActionSelect:()=>{},getUrgencyColor:e=>{switch(e){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},getStatusColor:e=>{switch(e){case"pending":default:return"text-gray-600 bg-gray-50 border-gray-200";case"in_progress":return"text-blue-600 bg-blue-50 border-blue-200";case"completed":return"text-green-600 bg-green-50 border-green-200";case"verified":return"text-purple-600 bg-purple-50 border-purple-200"}},getUrgencyLabel:e=>{switch(e){case"critical":return"Kritiek";case"high":return"Hoog";case"medium":return"Gemiddeld";case"low":return"Laag";default:return"Onbekend"}},getStatusLabel:e=>{switch(e){case"pending":return"In afwachting";case"in_progress":return"Bezig";case"completed":return"Voltooid";case"verified":return"Geverifieerd";default:return"Onbekend"}}})]})})]}),(0,i.jsx)(d.$,{})]})};function v(){let{user:e,loading:t}=(0,r.a)(),s=(0,l.useRouter)();return((0,a.useEffect)(()=>{t||e||s.push("/login")},[e,t,s]),t)?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)(u.T,{})}):e?(0,i.jsx)(j,{}):null}},8068:function(e,t,s){"use strict";s.d(t,{I:function(){return a}});var i=s(7437);let a=s(2265).forwardRef((e,t)=>{let{className:s,type:a,error:l,label:r,...n}=e;return(0,i.jsxs)("div",{className:"w-full",children:[r&&(0,i.jsx)("label",{className:"form-label",children:r}),(0,i.jsx)("input",{type:a,className:"form-input ".concat(l?"border-danger-300 focus:border-danger-500 focus:ring-danger-500":""," ").concat(s||""),ref:t,...n}),l&&(0,i.jsx)("p",{className:"form-error",children:l})]})});a.displayName="Input"}},function(e){e.O(0,[887,181,577,664,971,117,744],function(){return e(e.s=7856)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5742:function(e,t,r){Promise.resolve().then(r.bind(r,7340))},7340:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var o=r(7437),n=r(2265),a=r(9376),s=r(1618),u=r(5012);function i(){let{user:e,loading:t}=(0,s.a)(),r=(0,a.useRouter)();return((0,n.useEffect)(()=>{t||(e?"manager"===e.rol?r.push("/audits"):"user"===e.rol?r.push("/rapporten"):r.push("/dashboard"):r.push("/login"))},[e,t,r]),t)?(0,o.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,o.jsx)(u.T,{})}):null}},1618:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return i},a:function(){return u}});var o=r(7437),n=r(2265),a=r(1181);let s=(0,n.createContext)(void 0),u=()=>{let e=(0,n.useContext)(s);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},i=e=>{let{children:t}=e,[r,u]=(0,n.useState)(null),[i,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=async()=>{try{if("undefined"==typeof localStorage){console.log("\uD83C\uDF10 Server-side rendering detected, skipping auth check"),c(!1);return}let e=localStorage.getItem("audit_user");if(console.log("\uD83D\uDD0D Checking existing session..."),console.log("\uD83D\uDCE6 Saved user from localStorage:",e),e)try{let t=JSON.parse(e);console.log("\uD83D\uDC64 Parsed user:",t),console.log("\uD83D\uDD04 Using saved user directly (skipping database lookup)"),u(t),console.log("✅ User set from localStorage")}catch(e){console.error("❌ Error parsing localStorage user:",e),localStorage.removeItem("audit_user")}else console.log("\uD83D\uDCED No saved user found in localStorage")}catch(e){console.error("❌ Error in checkExistingSession:",e)}finally{console.log("\uD83C\uDFC1 Setting loading to false"),c(!1)}},t=setTimeout(()=>{console.log("⏰ Auth check timeout, setting loading to false"),c(!1)},3e3);e().finally(()=>{clearTimeout(t)})},[]);let l=async e=>{try{if("undefined"==typeof localStorage)return{success:!1,error:"Server-side rendering not supported"};let t=await a.l.getUserByEmail(e);if(t){let e={id:t.id,user_id:t.email,naam:t.naam,rol:t.rol,telefoon:t.telefoon,actief:t.actief,created_at:t.created_at,updated_at:t.updated_at};if(!e.actief)return{success:!1,error:"Account is gedeactiveerd"};return u(e),localStorage.setItem("audit_user",JSON.stringify(e)),{success:!0}}let r={ADMIN:{id:"00000000-0000-0000-0000-000000000001",user_id:"ADMIN",naam:"Admin User",rol:"admin",telefoon:"+32 123 456 789",actief:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},MAN01:{id:"00000000-0000-0000-0000-000000000002",user_id:"MAN01",naam:"COO Manager",rol:"coo",telefoon:"+32 123 456 790",actief:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},MAN02:{id:"00000000-0000-0000-0000-000000000003",user_id:"MAN02",naam:"District Manager",rol:"district_manager",telefoon:"+32 123 456 791",actief:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},USER1:{id:"00000000-0000-0000-0000-000000000004",user_id:"USER1",naam:"User",rol:"user",telefoon:"+32 123 456 792",actief:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}[e];if(!r)return{success:!1,error:"User ID niet gevonden"};if(!r.actief)return{success:!1,error:"Account is gedeactiveerd"};return u(r),localStorage.setItem("audit_user",JSON.stringify(r)),{success:!0}}catch(e){return{success:!1,error:"Er is een fout opgetreden bij het inloggen"}}},d=async()=>{u(null),"undefined"!=typeof localStorage&&localStorage.removeItem("audit_user")},g=async e=>{try{if(console.log("\uD83D\uDD04 updateUser called with updates:",e),!r)return console.log("❌ No user logged in"),{success:!1,error:"Geen gebruiker ingelogd"};if("undefined"==typeof localStorage)return{success:!1,error:"Server-side rendering not supported"};console.log("\uD83D\uDC64 Current user:",r),console.log("\uD83D\uDD0D Updating user in database with ID:",r.id);let t=await a.l.updateUser(r.id,e);if(console.log("\uD83D\uDCBE Database update result:",t),!t)return console.log("❌ User not found in database"),{success:!1,error:"Gebruiker niet gevonden"};let o={id:t.id,user_id:t.email,naam:t.naam,rol:t.rol,telefoon:t.telefoon,actief:t.actief,created_at:t.created_at,updated_at:t.updated_at};return console.log("✅ Converted to authUser:",o),console.log("\uD83D\uDCBE Updating localStorage..."),u(o),localStorage.setItem("audit_user",JSON.stringify(o)),console.log("✅ User updated successfully in both state and localStorage"),{success:!0}}catch(e){return console.error("❌ Error updating user:",e),{success:!1,error:"Er is een fout opgetreden bij het bijwerken van het profiel"}}};return(0,o.jsx)(s.Provider,{value:{user:r,loading:i,signOut:d,signIn:l,updateUser:g},children:t})}},5012:function(e,t,r){"use strict";r.d(t,{T:function(){return a}});var o=r(7437);r(2265);var n=r(5863);let a=e=>{let{size:t="md",text:r="Laden..."}=e;return(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50",children:[(0,o.jsx)(n.Z,{className:"".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t]," animate-spin text-primary-600")}),r&&(0,o.jsx)("p",{className:"mt-4 text-sm text-gray-600",children:r})]})}},9763:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var o=r(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=(e,t)=>{let r=(0,o.forwardRef)((r,s)=>{let{color:u="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:l,children:d,...g}=r;return(0,o.createElement)("svg",{ref:s,...n,width:i,height:i,stroke:u,strokeWidth:l?24*Number(c)/Number(i):c,className:"lucide lucide-".concat(a(e)),...g},[...t.map(e=>{let[t,r]=e;return(0,o.createElement)(t,r)}),...(Array.isArray(d)?d:[d])||[]])});return r.displayName="".concat(e),r}},5863:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});let o=(0,r(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9376:function(e,t,r){"use strict";var o=r(5475);r.o(o,"usePathname")&&r.d(t,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}}),r.o(o,"useSearchParams")&&r.d(t,{useSearchParams:function(){return o.useSearchParams}})}},function(e){e.O(0,[887,181,971,117,744],function(){return e(e.s=5742)}),_N_E=e.O()}]);
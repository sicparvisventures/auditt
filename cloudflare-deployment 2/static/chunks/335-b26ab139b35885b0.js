"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{7335:function(e,t,s){s.d(t,{C:function(){return b}});var a=s(7437),r=s(2265),n=s(9376),i=s(9178),c=s(4226),l=s(3637),d=s(4508),o=s(2141),x=s(5302),m=s(5131),u=s(2660),h=s(2735);let p=(0,s(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var g=s(1047),f=s(2369),y=s(8736),j=s(3417),v=s(5846),N=s(3581);let b=e=>{let{audit:t}=e,s=(0,n.useRouter)(),{addToast:b}=(0,l.p)(),[k,w]=(0,r.useState)(!1),Z=(0,d.yp)(t.pass_percentage>=80),_=t.pass_percentage>=80?x.Z:m.Z,C=t.resultaten.reduce((e,t)=>{if(!t.checklist_item)return console.warn("Missing checklist_item for result:",t),e;let s=t.checklist_item.categorie;return e[s]||(e[s]=[]),e[s].push(t),e},{}),z=async()=>{try{w(!0);let{data:e,error:s}=await o.O.from("rapporten").insert({audit_id:t.id,status:"pending",verstuurd_naar:[t.district_manager.email]}).select().single();if(s)throw s;b({title:"Rapport gegenereerd",message:"Het rapport wordt voorbereid en verzonden",variant:"success"})}catch(e){b({title:"Rapport fout",message:"Er is een fout opgetreden bij het genereren van het rapport",variant:"error"})}finally{w(!1)}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(c.z,{variant:"ghost",onClick:()=>s.back(),className:"mb-4",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Terug"]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Audit Details"}),(0,a.jsxs)("p",{className:"text-gray-600",children:[t.filiaal.naam," - ",t.filiaal.locatie]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Door: ",t.district_manager.naam," â€¢ ",(0,d.p6)(t.audit_datum)]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(_,{className:"h-5 w-5 ".concat(Z.color)}),(0,a.jsx)("span",{className:"text-lg font-semibold ".concat(Z.color),children:Z.text})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Score: ",(0,d.o6)(t.totale_score),"/5.0 (",(0,d.rl)(t.pass_percentage),")"]})]})})]})]}),(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap gap-3",children:[(0,a.jsxs)(c.z,{onClick:()=>{b({title:"PDF Export",message:"PDF export functionaliteit wordt ge\xefmplementeerd",variant:"info"})},children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),(0,a.jsxs)(c.z,{variant:"secondary",onClick:z,disabled:k,children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),k?"Genereren...":"Verstuur Rapport"]})]}),(0,a.jsxs)(i.Zb,{className:"mb-6",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Audit Samenvatting"})}),(0,a.jsxs)(i.eW,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("img",{src:"/logo_poule.png",alt:"Poule & Poulette Logo",className:"h-5 w-auto"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Filiaal"}),(0,a.jsx)("p",{className:"font-medium",children:t.filiaal.naam})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Datum"}),(0,a.jsx)("p",{className:"font-medium",children:(0,d.p6)(t.audit_datum)})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Auditor"}),(0,a.jsx)("p",{className:"font-medium",children:t.district_manager.naam})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(y.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,a.jsx)("p",{className:"font-medium capitalize",children:t.status})]})]})]}),t.opmerkingen&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Algemene Opmerkingen"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:t.opmerkingen})]})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:Object.entries(C).map(e=>{let[t,s]=e;return(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:t})}),(0,a.jsx)(i.eW,{children:(0,a.jsx)("div",{className:"space-y-4",children:s.map(e=>{let t="ok"===e.resultaat?x.Z:m.Z,s="ok"===e.resultaat?"text-success-600":"text-danger-600";return e.checklist_item?(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(t,{className:"h-5 w-5 mt-0.5 ".concat(s)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.checklist_item.titel}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.checklist_item.beschrijving})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"badge ".concat("ok"===e.resultaat?"badge-success":"badge-danger"),children:"ok"===e.resultaat?"OK":"Niet OK"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Score: ",e.score,"/5"]})]})]}),e.opmerkingen&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 text-gray-400 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Opmerkingen"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.opmerkingen})]})]})}),e.verbeterpunt&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 text-warning-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Verbeterpunt"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.verbeterpunt})]})]})}),e.foto_urls&&e.foto_urls.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Foto's (",e.foto_urls.length,")"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:e.foto_urls.map((e,t)=>(0,a.jsx)("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:(0,a.jsx)("img",{src:e,alt:"Audit foto ".concat(t+1),className:"w-full h-full object-cover cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>window.open(e,"_blank")})},t))})]})]},e.id):null})})})]},t)})}),t.rapport&&(0,a.jsxs)(i.Zb,{className:"mt-6",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Rapport Status"})}),(0,a.jsx)(i.eW,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Status: ",(0,a.jsx)("span",{className:"font-medium capitalize",children:t.rapport.status})]}),t.rapport.verstuur_datum&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Verzonden: ",(0,d.p6)(t.rapport.verstuur_datum)]})]}),t.rapport.rapport_url&&(0,a.jsxs)(c.z,{variant:"secondary",onClick:()=>window.open(t.rapport.rapport_url,"_blank"),children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Download Rapport"]})]})})]})]})}},4226:function(e,t,s){s.d(t,{z:function(){return r}});var a=s(7437);let r=s(2265).forwardRef((e,t)=>{let{className:s,variant:r="primary",size:n="md",loading:i,children:c,disabled:l,...d}=e;return(0,a.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-black text-white hover:bg-[#c59a6d] focus:ring-[#c59a6d]",secondary:"bg-black text-white border border-black hover:bg-[#c59a6d] focus:ring-[#c59a6d]",success:"bg-success-600 text-white hover:bg-success-700 focus:ring-success-500",warning:"bg-warning-600 text-white hover:bg-warning-700 focus:ring-warning-500",danger:"bg-danger-600 text-white hover:bg-danger-700 focus:ring-danger-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500"}[r]," ").concat({sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[n]," ").concat(s||""),style:{borderRadius:0},ref:t,disabled:l||i,...d,children:[i&&(0,a.jsxs)("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]})});r.displayName="Button"},9178:function(e,t,s){s.d(t,{Ol:function(){return i},Zb:function(){return n},eW:function(){return c}});var a=s(7437),r=s(2265);let n=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:"card ".concat(s||""),...n,children:r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:"card-header ".concat(s||""),...n,children:r})});i.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:"card-body ".concat(s||""),...n,children:r})});c.displayName="CardBody",r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:"card-footer ".concat(s||""),...n,children:r})}).displayName="CardFooter"},3637:function(e,t,s){s.d(t,{ToastProvider:function(){return l},p:function(){return c}});var a=s(7437),r=s(2265),n=s(2489);let i=(0,r.createContext)(void 0),c=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useToast must be used within a ToastProvider");return e},l=e=>{let{children:t}=e,[s,c]=(0,r.useState)([]),l=(0,r.useCallback)(e=>{let t=Math.random().toString(36).substring(2,9),s={...e,id:t};c(e=>[...e,s]),setTimeout(()=>{d(t)},e.duration||5e3)},[]),d=(0,r.useCallback)(e=>{c(t=>t.filter(t=>t.id!==e))},[]);return(0,a.jsxs)(i.Provider,{value:{toasts:s,addToast:l,removeToast:d},children:[t,(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:s.map(e=>(0,a.jsx)("div",{className:"max-w-sm w-full bg-white shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[e.title&&(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.message})]}),(0,a.jsx)("div",{className:"ml-4 flex-shrink-0 flex",children:(0,a.jsxs)("button",{className:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",onClick:()=>d(e.id),children:[(0,a.jsx)("span",{className:"sr-only",children:"Sluiten"}),(0,a.jsx)(n.Z,{className:"h-5 w-5"})]})})]})})},e.id))})]})}},4508:function(e,t,s){function a(e){return new Date(e).toLocaleDateString("nl-NL",{year:"numeric",month:"long",day:"numeric"})}function r(e){return e.toFixed(1)}function n(e){return"".concat(e.toFixed(1),"%")}function i(e){return e?{text:"Pass",color:"text-success-600"}:{text:"Fail",color:"text-danger-600"}}s.d(t,{o6:function(){return r},p6:function(){return a},rl:function(){return n},yp:function(){return i}})},2660:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},3581:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},5302:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2735:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},8736:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},5846:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]])},3417:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},2369:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5131:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},2489:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,t,s){var a=s(5475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}}]);
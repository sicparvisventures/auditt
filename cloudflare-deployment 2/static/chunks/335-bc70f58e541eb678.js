"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[335],{7335:function(e,s,t){t.d(s,{C:function(){return b}});var a=t(7437),r=t(2265),i=t(9376),n=t(9178),c=t(4226),l=t(3637),d=t(4508),o=t(2141),x=t(5302),m=t(5131),u=t(2660),h=t(2735);let p=(0,t(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var g=t(1047),f=t(2369),j=t(8736),y=t(3417),N=t(5846),v=t(3581);let b=e=>{let{audit:s}=e,t=(0,i.useRouter)(),{addToast:b}=(0,l.p)(),[w,k]=(0,r.useState)(!1),Z=(0,d.yp)(s.pass_percentage>=80),_=s.pass_percentage>=80?x.Z:m.Z,C=s.resultaten.reduce((e,s)=>{if(!s.checklist_item)return console.warn("Missing checklist_item for result:",s),e;let t=s.checklist_item.categorie;return e[t]||(e[t]=[]),e[t].push(s),e},{}),z=async()=>{try{k(!0);let{data:e,error:t}=await o.O.from("rapporten").insert({audit_id:s.id,status:"pending",verstuurd_naar:[s.district_manager.email]}).select().single();if(t)throw t;b({title:"Rapport gegenereerd",message:"Het rapport wordt voorbereid en verzonden",variant:"success"})}catch(e){b({title:"Rapport fout",message:"Er is een fout opgetreden bij het genereren van het rapport",variant:"error"})}finally{k(!1)}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(c.z,{variant:"ghost",onClick:()=>t.back(),className:"mb-4",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Terug"]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Audit Details"}),(0,a.jsxs)("p",{className:"text-gray-600",children:[s.filiaal.naam," - ",s.filiaal.locatie]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Door: ",s.district_manager.naam," â€¢ ",(0,d.p6)(s.audit_datum)]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(_,{className:"h-5 w-5 ".concat(Z.color)}),(0,a.jsx)("span",{className:"text-lg font-semibold ".concat(Z.color),children:Z.text})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Score: ",(0,d.o6)(s.totale_score),"/5.0 (",(0,d.rl)(s.pass_percentage),")"]})]})})]})]}),(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap gap-3",children:[(0,a.jsxs)(c.z,{onClick:()=>{b({title:"PDF Export",message:"PDF export functionaliteit wordt ge\xefmplementeerd",variant:"info"})},children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),(0,a.jsxs)(c.z,{variant:"secondary",onClick:z,disabled:w,children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),w?"Genereren...":"Verstuur Rapport"]})]}),(0,a.jsxs)(n.Zb,{className:"mb-6",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Audit Samenvatting"})}),(0,a.jsxs)(n.eW,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("img",{src:"/logo_poule.png",alt:"Poule & Poulette Logo",className:"h-5 w-auto"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Filiaal"}),(0,a.jsx)("p",{className:"font-medium",children:s.filiaal.naam})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(g.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Datum"}),(0,a.jsx)("p",{className:"font-medium",children:(0,d.p6)(s.audit_datum)})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(f.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Auditor"}),(0,a.jsx)("p",{className:"font-medium",children:s.district_manager.naam})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(j.Z,{className:"h-5 w-5 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,a.jsx)("p",{className:"font-medium capitalize",children:s.status})]})]})]}),s.opmerkingen&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Algemene Opmerkingen"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:s.opmerkingen})]})]})]}),(0,a.jsx)("div",{className:"space-y-6",children:Object.entries(C).map(e=>{let[s,t]=e;return(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:s})}),(0,a.jsx)(n.eW,{children:(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{let s="ok"===e.resultaat?x.Z:m.Z,t="ok"===e.resultaat?"text-success-600":"text-danger-600";return e.checklist_item?(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(s,{className:"h-5 w-5 mt-0.5 ".concat(t)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.checklist_item.titel}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.checklist_item.beschrijving})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("span",{className:"badge ".concat("ok"===e.resultaat?"badge-success":"badge-danger"),children:"ok"===e.resultaat?"OK":"Niet OK"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Score: ",e.score,"/5"]})]})]}),e.opmerkingen&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(y.Z,{className:"h-4 w-4 text-gray-400 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Opmerkingen"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.opmerkingen})]})]})}),e.verbeterpunt&&(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4 text-warning-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Verbeterpunt"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.verbeterpunt})]})]})}),e.foto_urls&&e.foto_urls.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Foto's (",e.foto_urls.length,")"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:e.foto_urls.map((e,s)=>(0,a.jsx)("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:(0,a.jsx)("img",{src:e,alt:"Audit foto ".concat(s+1),className:"w-full h-full object-cover cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>window.open(e,"_blank")})},s))})]})]},e.id):null})})})]},s)})}),s.rapport&&(0,a.jsxs)(n.Zb,{className:"mt-6",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Rapport Status"})}),(0,a.jsx)(n.eW,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Status: ",(0,a.jsx)("span",{className:"font-medium capitalize",children:s.rapport.status})]}),s.rapport.verstuur_datum&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Verzonden: ",(0,d.p6)(s.rapport.verstuur_datum)]})]}),s.rapport.rapport_url&&(0,a.jsxs)(c.z,{variant:"secondary",onClick:()=>window.open(s.rapport.rapport_url,"_blank"),children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 mr-2"}),"Download Rapport"]})]})})]})]})}},4226:function(e,s,t){t.d(s,{z:function(){return r}});var a=t(7437);let r=t(2265).forwardRef((e,s)=>{let{className:t,variant:r="primary",size:i="md",loading:n,children:c,disabled:l,...d}=e;return(0,a.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-black text-white hover:bg-[#c59a6d] focus:ring-[#c59a6d]",secondary:"bg-black text-white border border-black hover:bg-[#c59a6d] focus:ring-[#c59a6d]",success:"bg-success-600 text-white hover:bg-success-700 focus:ring-success-500",warning:"bg-warning-600 text-white hover:bg-warning-700 focus:ring-warning-500",danger:"bg-danger-600 text-white hover:bg-danger-700 focus:ring-danger-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500"}[r]," ").concat({sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[i]," ").concat(t||""),style:{borderRadius:0},ref:s,disabled:l||n,...d,children:[n&&(0,a.jsxs)("svg",{className:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]})});r.displayName="Button"},9178:function(e,s,t){t.d(s,{Ol:function(){return n},Zb:function(){return i},eW:function(){return c}});var a=t(7437),r=t(2265);let i=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsx)("div",{ref:s,className:"card ".concat(t||""),...i,children:r})});i.displayName="Card";let n=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsx)("div",{ref:s,className:"card-header ".concat(t||""),...i,children:r})});n.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsx)("div",{ref:s,className:"card-body ".concat(t||""),...i,children:r})});c.displayName="CardBody",r.forwardRef((e,s)=>{let{className:t,children:r,...i}=e;return(0,a.jsx)("div",{ref:s,className:"card-footer ".concat(t||""),...i,children:r})}).displayName="CardFooter"},3637:function(e,s,t){t.d(s,{ToastProvider:function(){return l},p:function(){return c}});var a=t(7437),r=t(2265),i=t(2489);let n=(0,r.createContext)(void 0),c=()=>{let e=(0,r.useContext)(n);if(!e)throw Error("useToast must be used within a ToastProvider");return e},l=e=>{let{children:s}=e,[t,c]=(0,r.useState)([]),l=(0,r.useCallback)(e=>{let s=Math.random().toString(36).substring(2,9),t={...e,id:s};c(e=>[...e,t]),setTimeout(()=>{d(s)},e.duration||5e3)},[]),d=(0,r.useCallback)(e=>{c(s=>s.filter(s=>s.id!==e))},[]);return(0,a.jsxs)(n.Provider,{value:{toasts:t,addToast:l,removeToast:d},children:[s,(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:t.map(e=>(0,a.jsx)("div",{className:"max-w-sm w-full bg-white shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[e.title&&(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.message})]}),(0,a.jsx)("div",{className:"ml-4 flex-shrink-0 flex",children:(0,a.jsxs)("button",{className:"bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",onClick:()=>d(e.id),children:[(0,a.jsx)("span",{className:"sr-only",children:"Sluiten"}),(0,a.jsx)(i.Z,{className:"h-5 w-5"})]})})]})})},e.id))})]})}},2141:function(e,s,t){t.d(s,{O:function(){return a}});let a=(0,t(3887).eI)("https://kauerobifkgjvddyrkuz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImthdWVyb2JpZmtnanZkZHlya3V6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxNTIxODQsImV4cCI6MjA3NDcyODE4NH0.GqMYsz9byBYHw_fqmPYH53E4fyciz3MpdUtDQDhpvd8")},4508:function(e,s,t){function a(e){return new Date(e).toLocaleDateString("nl-NL",{year:"numeric",month:"long",day:"numeric"})}function r(e){return e.toFixed(1)}function i(e){return"".concat(e.toFixed(1),"%")}function n(e){return e?{text:"Pass",color:"text-success-600"}:{text:"Fail",color:"text-danger-600"}}t.d(s,{o6:function(){return r},p6:function(){return a},rl:function(){return i},yp:function(){return n}})},1047:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},3581:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},2735:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},5846:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]])},3417:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},5131:function(e,s,t){t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}}]);